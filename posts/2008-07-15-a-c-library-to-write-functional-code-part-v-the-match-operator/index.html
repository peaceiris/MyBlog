<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#ffffff"/>


<meta name="description" content="Other posts in the series:
  Part I - Background
  Part II - Tuples
 Part III - Records Part IV - Type Unions{.} Part V - The Match operator{.} This is my last post of this series. It is about the match operator. To the untrained eyes this operator might look like a case statement. But they are different.  The match operator combines control flow and decomposition in a single construct.">





<link rel="preload" href="../../fonts/SourceSerifVariable-Roman.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../fonts/SourceSansVariable-Roman.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<link rel="stylesheet" href="../../css/base.css"> 
<link rel="stylesheet" href="../../css/fonts.css">


  <link rel="preload" href="../../fonts/SourceCodeVariable-Roman.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="../../fonts/SourceCodeVariable-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="../../fonts/SourceSerifVariable-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">



  <title>A C# library to write functional code - Part V - The Match operator | Lucabol blog</title>


<link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="manifest" href="../../site.webmanifest">
    </head>
<body>
    <header>
        <div id="topnav">
            <a id="logo" href="../../">❧</a>
            
                <time id="blog_date" > 2008/07/07</time>
            
            <span class="offline">~~ Offline ~~</span>
            <span class="rightnav">
                <a id="theme">theme</a><div class="dropdown-content">
          <a class="font-name" data-classname="OpenDyslexic" >0. OpenDyslexic</a>
          <a class="font-name" data-classname="Cardo" >1. Se Old Style: Cardo (Minion, Gallard, Centaur)</a>
          <a class="font-name" data-classname="CrimsonPro" >1. Se Old Style: Crimson Pro (Century, Palatino, Plantin, Sabon)</a>
          <a class="font-name" data-classname="EBGaramond" >1. Se Old Style: Garamond</a>
          <a class="font-name" data-classname="Gentium" >1. Se Old Style: Gentium</a>
          <a class="font-name" data-classname="GoudyStM" >1. Se Old Style: Sorts Mill Goudy</a>
          <a class="font-name" data-classname="LibreBaskerville" >4. Se Transitional: Libre Bask. (Mrs Eaves)</a>
          <a class="font-name" data-classname="LibreCaslon" >4. Se Transitional: Libre Caslon</a>
          <a class="font-name" data-classname="PT" >4. Se Transitional: PT fonts (Le Monde)</a>
          <a class="font-name" data-classname="SourcePro" >4. Se Transitional: Source Pro (Skolar, Fournier)</a>
          <a class="font-name" data-classname="TimesNewRoman" >4. Se Transitional: Times New Roman</a>
          <a class="font-name" data-classname="CM" >5. Se Didone: Computer Modern</a>
          <a class="font-name" data-classname="OldStandardTT" >5. Se Didone: Old Standard TT (Filosofia, Scotch Modern)</a>
          <a class="font-name" data-classname="STIX2" >5. Se Didone: Stix2</a>
          <a class="font-name" data-classname="Charter" >6. Se Scotch: Charter</a>
          <a class="font-name" data-classname="Georgia" >6. Se Scotch: Georgia</a>
          <a class="font-name" data-classname="WorkSans" >8. Sa Grotesque: Work Sans (All Grotesque, FF Bau, Venus)</a>
          <a class="font-name" data-classname="AntiqueOlive" >9. Sa Geometric: Antique Oliv</a>
          <a class="font-name" data-classname="bahnschrift" >9. Sa Geometric: Bahnschrift</a>
          <a class="font-name" data-classname="CooperHewitt" >9. Sa Geometric: Cooper Hewitt (Calibre)</a>
          <a class="font-name" data-classname="SourceSans" >9. Sa Humanist: Source Sans (Balto, Adelle Sans)</a>
          <a class="font-name" data-classname="URWClassico" >9. Sa Humanist: URW Classico (Optima)</a>
          <a class="font-name" data-classname="FiraSans" >a. Sa Humanist: Fira Sans (FF Meta)</a>
          <a class="font-name" data-classname="Nimbus" >a. Sa Humanist: Nimbus (Helvetica)</a>
          <a class="font-name" data-classname="Roboto" >a. Sa Humanist: Roboto (DIN</a>
          <a class="font-name" data-classname="Munson" >b. Sl Grotesque: Munson (Clarendon)</a>
          <a class="font-name" data-classname="Sanchez" >c. Sl Geometric: Sanchez (Rockwell)</a>
          <a class="font-name" data-classname="Enriqueta" >d. Sl Humanist: Enriqueta (PMN Caecilia)</a>
          <a class="font-name" data-classname="Merriweather" >d. Sl Humanist: Merriweather (Chapparal)</a>
          <a class="font-name" data-classname="profont" >Z. Sa Monospace: Profont</a>
</div>
                <a id="to_nav">Menu</a>
                <nav id="primary_nav">
                    

  <a href="../../MyBlog/">home</a>
  <a href="../../MyBlog/tags/">tags</a>
  <a href="https://www.github.com/lucabol">github</a>
  <a href="https://www.linkedin.com/in/lucabolognese/">linkdin</a>
  <a href="../../MyBlog/search">search</a>
  <a href="../../MyBlog/index.xml">rss</a>
                </nav>
            </span>
        </div>
    <h1 id="title">
    
        A C# library to write functional code - Part V - The Match operator
    
    </h1>

    </header>

    <main>
        

<p>Other posts in the series:</p>
<ul>
<li>
<p><a href="http://blogs.msdn.com/lucabol/archive/2008/04/01/a-c-library-to-write-functional-code-part-i-background.aspx"><strong><font color="#006bad">Part I  - Background</font></strong></a></p>
<ul>
<li>
<p><a href="http://blogs.msdn.com/lucabol/archive/2008/04/08/a-c-library-to-write-functional-code-part-ii-tuples.aspx"><strong><font color="#006bad">Part II  - Tuples</font></strong></a></p>
<ul>
<li><strong><a href="http://blogs.msdn.com/lucabol/archive/2008/04/21/a-c-library-to-write-functional-code-part-iii-records.aspx"><font color="#006bad">Part III  - Records</font></a></strong></li>
<li><strong><a href="http://blogs.msdn.com/lucabol/archive/2008/06/06/a-c-library-to-write-functional-code-part-iv-type-unions.aspx">Part IV  - Type Unions</a>{.}</strong></li>
<li><strong><a href="http://blogs.msdn.com/lucabol/archive/2008/07/15/a-c-library-to-write-functional-code-part-v-the-match-operator.aspx">Part V  - The Match operator</a>{.}</strong>
This is my last post of this series. It is about the <em>match</em> operator. To the untrained eyes this operator might look like a case statement. But they are different.</li>
</ul>
<p>The <em>match</em> operator combines control flow and decomposition in a single construct. As it often happens, even if these two things are well known concepts, putting them together gives you a different perspective on your code.</p>
<p>I have to admit that the similarity with a case statement triggered all sorts of bad reactions in my OO trained mind. Phrases from wise gurus on the tone of never use an ‘if&rsquo; statement was echoing in my mind. After a while I got over it and enjoyed the power that this operator gives.</p>
<p>In this library we won&rsquo;t get close to the beauty of the <em>match</em> operator in functional languages (i.e. F#), especially the decomposition piece. There might be a way to do better than this in C#, but this was enough for my purpose of learning about functional programming, so I didn&rsquo;t investigate further. Learning was my real goal.</p>
<p><strong>How to use it</strong></p>
<p>There are two versions of this operator. Let&rsquo;s start from the more eye pleasing one.</p>
<p>Let&rsquo;s assume a discriminated union like the following:</p>
<pre class="code"><span style="color:blue;">public class </span><span style="color:#2b91af;">Node </span>: <span style="color:#2b91af;">TypeUnion</span>&lt;<span style="color:blue;">int</span>, <span style="color:blue;">string</span>&gt; {
</li>
</ul>
<p><span style="color:blue;">public </span>Node(<span style="color:blue;">int </span>i) : <span style="color:blue;">base</span>(i) { }
<span style="color:blue;">public </span>Node(<span style="color:blue;">string </span>s) : <span style="color:blue;">base</span>(s) { }
<span style="color:blue;">public int </span>IntNode { <span style="color:blue;">get </span>{ <span style="color:blue;">return </span>Type1; } }
<span style="color:blue;">public string </span>StringNode { <span style="color:blue;">get </span>{ <span style="color:blue;">return </span>Type2; } }
}</pre></p>
<pre><code>I can then match against this union with the following code:
    
&lt;pre class=&quot;code&quot;&gt;&lt;span style=&quot;color:blue;&quot;&gt;var &lt;/span&gt;no = &lt;span style=&quot;color:blue;&quot;&gt;new &lt;/span&gt;&lt;span style=&quot;color:#2b91af;&quot;&gt;Node&lt;/span&gt;(35);
</code></pre>
</li>
</ul>
<p>r = <span style="color:#2b91af;">F</span>.Match(no,
(<span style="color:blue;">int </span>i)    =&gt; (i + 3).ToString(),
(<span style="color:blue;">string </span>s) =&gt; s<br />            );
<span style="color:#2b91af;">Assert</span>.AreEqual(<span style="color:#a31515;">&quot;38&quot;</span>, r);</pre></p>
<pre><code>    Note that the _match_ operator behaves a bit like a case statement, but it also gives you the &amp;#8216;right' type on the right of the &amp;#8216;=&gt;' for you to write code against.
    
    I have to admit I'm rather happy of this syntax, but it has one severe limitation. You need to specify all the types of the type union and they have to be in the same order. For example, in the previous code I cannot match against _string_ first and _int_ second. I consider this to be a big deal.
    
    A different implementation of match that doesn't have that limitation is as follows:
    
    &lt;pre class=&quot;code&quot;&gt;no = &lt;span style=&quot;color:blue;&quot;&gt;new &lt;/span&gt;&lt;span style=&quot;color:#2b91af;&quot;&gt;Node&lt;/span&gt;(&lt;span style=&quot;color:#a31515;&quot;&gt;&quot;35&quot;&lt;/span&gt;);
</code></pre>
<p>r = <span style="color:#2b91af;">F</span>.Match(no,
n =&gt; n.Is&lt;<span style="color:blue;">int</span>&gt;(),   n =&gt; (n.As&lt;<span style="color:blue;">int</span>&gt;() + 3).ToString(),
n =&gt; n.Is&lt;<span style="color:blue;">string</span>&gt;(),n =&gt; n.As&lt;<span style="color:blue;">string</span>&gt;());
<span style="color:#2b91af;">Assert</span>.AreEqual(<span style="color:#a31515;">&quot;35&quot;</span>, r);</pre></p>
<pre><code>    Rather less pleasing to the eyes, but more robust to use.
    
    By using this more generic version, you can obviously match against all the constructs we described in this series. I.E. against _Tuples_:
    
    &lt;pre class=&quot;code&quot;&gt;&lt;span style=&quot;color:blue;&quot;&gt;var &lt;/span&gt;t = &lt;span style=&quot;color:#2b91af;&quot;&gt;F&lt;/span&gt;.Tuple(&lt;span style=&quot;color:#a31515;&quot;&gt;&quot;msft&quot;&lt;/span&gt;, 10, &lt;span style=&quot;color:#a31515;&quot;&gt;&quot;Nasdaq&quot;&lt;/span&gt;);
</code></pre>
<p><span style="color:blue;">var </span>r = <span style="color:#2b91af;">F</span>.Match(t,
i =&gt; i.Item2 &lt; 5 &amp;&amp; i.Item3 == <span style="color:#a31515;">&quot;OTC&quot;</span>, <br />         i =&gt; i.Item1 + <span style="color:#a31515;">&rdquo; is low price OTC stock&quot;</span>,
i =&gt; i.Item3 == <span style="color:#a31515;">&quot;OTC&quot;</span>,<br />         i =&gt; i.Item1 + <span style="color:#a31515;">&quot;is a normal OTC stock&quot;</span>,
i =&gt; i.Item3 == <span style="color:#a31515;">&quot;Nasdaq&quot;</span>, <br />         i =&gt; i.Item1 + <span style="color:#a31515;">&rdquo; is a Nasdaq stock&quot;</span>);
<span style="color:#2b91af;">Assert</span>.AreEqual(<span style="color:#a31515;">&quot;msft is a Nasdaq stock&quot;</span>, r);</pre></p>
<pre><code>    &amp;nbsp;
    
    Or against sequences:
    
    &lt;pre class=&quot;code&quot;&gt;&lt;span style=&quot;color:blue;&quot;&gt;var &lt;/span&gt;i1 = &lt;span style=&quot;color:blue;&quot;&gt;new int&lt;/span&gt;[] { 1, 2, 3, 4, 5, 6, 7 };
</code></pre>
<p><span style="color:blue;">var </span>r1 = <span style="color:#2b91af;">F</span>.Match(i1,
s =&gt; s.SequenceEqual(<span style="color:blue;">new int</span>[] { 1, 2}),    <br />                       s =&gt; s.Where(i =&gt; i &lt; 4),
s =&gt; s.First() == 2,                        <br />                       s =&gt; s.Where(i =&gt; i == 1),
s =&gt; s.Last() == 6,                         <br />                       s =&gt; s.Select(i =&gt; i * i),
s =&gt; <span style="color:blue;">true</span>,                                  <br />                       s =&gt; s.Where(i =&gt; i &lt; 7));
<span style="color:#2b91af;">Assert</span>.IsTrue(i1.Take(6).SequenceEqual(r1));</pre></p>
<pre><code>    The match operator, as I defined it, is very flexible (probably too flexible as it doesn't use the type system to enforce much).
    
    **How it is implemented**
    
    Let's start from the special _match_ against union types: the one that is beautiful but flawed. Its implementation looks just like this (I just show the two parameters version):
    
    &lt;pre class=&quot;code&quot;&gt;&lt;span style=&quot;color:blue;&quot;&gt;public static &lt;/span&gt;R Match&amp;lt;T1, T2, R&amp;gt;(&lt;br /&gt;                           &lt;span style=&quot;color:blue;&quot;&gt;this &lt;/span&gt;&lt;span style=&quot;color:#2b91af;&quot;&gt;TypeUnion&lt;/span&gt;&amp;lt;T1, T2&amp;gt; u,&lt;br /&gt;                           &lt;span style=&quot;color:#2b91af;&quot;&gt;Func&lt;/span&gt;&amp;lt;T1, R&amp;gt; f1, &lt;span style=&quot;color:#2b91af;&quot;&gt;Func&lt;/span&gt;&amp;lt;T2, R&amp;gt; f2) {
&lt;span style=&quot;color:blue;&quot;&gt;if &lt;/span&gt;(u.Is&amp;lt;T1&amp;gt;()) &lt;span style=&quot;color:blue;&quot;&gt;return &lt;/span&gt;f1(u.As&amp;lt;T1&amp;gt;());
&lt;span style=&quot;color:blue;&quot;&gt;if &lt;/span&gt;(u.Is&amp;lt;T2&amp;gt;()) &lt;span style=&quot;color:blue;&quot;&gt;return &lt;/span&gt;f2(u.As&amp;lt;T2&amp;gt;());
&lt;span style=&quot;color:blue;&quot;&gt;throw new &lt;/span&gt;&lt;span style=&quot;color:#2b91af;&quot;&gt;Exception&lt;/span&gt;(&lt;span style=&quot;color:#a31515;&quot;&gt;&quot;No Match for this Union Type&quot;&lt;/span&gt;);
</code></pre>
<p>}</pre></p>
<pre><code>    It is easy to see the reason for the limitations of this function. The same thing that gives you type inference (nice to look at) also gives you the problem with the ordering of lambdas. Also note the I originally intended to have these as extension methods. In practice I ended up liking more the F.Match syntax. De gustibus I assume
    
    The more general version looks like this:
    
    &lt;pre class=&quot;code&quot;&gt;&lt;span style=&quot;color:blue;&quot;&gt;public static &lt;/span&gt;R Match&amp;lt;T, R&amp;gt;(&lt;span style=&quot;color:blue;&quot;&gt;this &lt;/span&gt;T t,
&lt;span style=&quot;color:#2b91af;&quot;&gt;Func&lt;/span&gt;&amp;lt;T, &lt;span style=&quot;color:blue;&quot;&gt;bool&lt;/span&gt;&amp;gt; match1, &lt;span style=&quot;color:#2b91af;&quot;&gt;Func&lt;/span&gt;&amp;lt;T, R&amp;gt; func1,
&lt;span style=&quot;color:#2b91af;&quot;&gt;Func&lt;/span&gt;&amp;lt;T, &lt;span style=&quot;color:blue;&quot;&gt;bool&lt;/span&gt;&amp;gt; match2, &lt;span style=&quot;color:#2b91af;&quot;&gt;Func&lt;/span&gt;&amp;lt;T, R&amp;gt; func2) {
&lt;span style=&quot;color:blue;&quot;&gt;if &lt;/span&gt;(match1(t))
    &lt;span style=&quot;color:blue;&quot;&gt;return &lt;/span&gt;func1(t);
&lt;span style=&quot;color:blue;&quot;&gt;if &lt;/span&gt;(match2(t))
    &lt;span style=&quot;color:blue;&quot;&gt;return &lt;/span&gt;func2(t);
&lt;span style=&quot;color:blue;&quot;&gt;throw new &lt;/span&gt;&lt;span style=&quot;color:#2b91af;&quot;&gt;Exception&lt;/span&gt;(&lt;span style=&quot;color:#a31515;&quot;&gt;&quot;Nothing matches&quot;&lt;/span&gt;);
</code></pre>
<p>}</pre></p>
<pre><code>    Again, it is easy to see in the implementation that this is an extremely general thing: a glorified case statement really. This is the beauty of it (you can match against anything) and the ugliness of it (you can write anything as _match1_ of _func1_, even code that doesn't reference _t_ at all).
    
    **How to use this series to learn functional programming**
    
    Here is how I did it (it worked for me). Take this library and force yourself to write a medium size program using &lt;u&gt;just&lt;/u&gt; these constructs.
    
    I mean it. No objects, just records. No inheritance, just discriminated unions. Tuples to return values. Match operators everywhere. No iteration statements (for, while, etc), just recursion. Extensive use of sequence operators. After a while I noticed that all my functions had the same pattern: they just match against the input and produce an output, usually by calling other functions or recursively calling themselves.
    
    Obviously, this is overcompensating. After a while you will realize the different trade offs that come with a functional vs OO style of programming. At that point you'll be able to get the best of the two. Or maybe you'll be royally confused
    
    At that point I picked up F# and I'm now enjoying the fact that all these constructs are directly embedded in the language (and yes, you can use while statements too).</code></pre>



  
  <div id="disqus-container">
  
    <button id="disqus-button" onclick="showComments()">Show comments</button>
    <div id="disqus-comments">
      
      
      
        <div id="disqus_thread">
        </div>
        <script type="application/javascript">
          function showComments() {
            var disqus_config = function () {
};
// Build and append comments 
var d = document;
var s = d.createElement('script');
s.async = true;
s.src = '//' + "lucabol" + '.disqus.com/embed.js';
s.setAttribute('data-timestamp', + new Date());
(d.head || d.body).appendChild(s);
            // Remove button
var disqusButton = document.getElementById('disqus-button');
disqusButton.parentNode.removeChild(disqusButton); 
// Un-hide comments
var disqusComments = document.getElementById('disqus-comments');
disqusComments.style.display = 'block'; 
          }
        </script>
      
      <noscript>Enable JavaScript to view Disqus comments.</noscript>
    </div>
  
</div>




    </main>

    <aside id="sidebar-left">
        
<div id="tags">
  <header>
    <h1>Tags</h1>
      
    <h2>¶</h2>
    
  </header>
  
    
    <nav>
      <ul>
        
            <li><a href="../../MyBlog/tags/csharp">csharp</a></li>
        
      </ul>
    </nav>
    
  
</div>

    </aside>

    <aside id="sidebar-right">
        <section id="TOC">
        
  
    <header>
        <h1>Table of contents</h1>
        <h2>¶</h2>
    </header>
    


        </section>
    </aside>

    <a id="to_top" href="#top">Top</a>
    <footer>
        
    </footer>

    <script>
    const th = document.querySelector("#theme")
    th.addEventListener("click", e => {
        const x = document.querySelector(".dropdown-content")
        if (x.style.display === "block") {
            x.removeAttribute("style")
        } else {
            x.style.display = "block";
        }
    })
    const children = document.querySelectorAll(".font-name")
    const allStyles = Array.from(children).map(c => c.dataset.classname)

    const defaultStyle = "TimesNewRoman"
    const retrievedStyle = localStorage.getItem("Style")
    const style = allStyles.includes(retrievedStyle) ? retrievedStyle : defaultStyle
    document.body.className = style;

    const fontEl = document.querySelector(".dropdown-content")
    fontEl.addEventListener("click", e => {
        const el = e.target
        const style = el.dataset.classname
        document.body.className = style;
        localStorage.setItem("Style", style)
    })



</script>
    <script>
const init = () => {

    
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    
    window.ga = window.ga || ((...args) => (ga.q = ga.q || []).push(args));

    ga('create', 'UA-133194891-1', 'auto');
    ga('set', 'transport', 'beacon');
    ga('send', 'pageview');
};


window.addEventListener('load', init);
</script>
    <script>
    if("serviceWorker" in navigator){
        navigator.serviceWorker.register("/sw.js");
    }
</script>
    <script>
    window.addEventListener('offline', (e) => {
        const els = document.getElementsByClassName('offline')
        for(const el of els)
            el.classList.add("show")
        window.caches.keys().then(strikeNonCached)
    })
    window.addEventListener('online', (e) => {
        const els = document.getElementsByClassName('offline')
        for(const el of els)
            el.classList.remove("show")

        const as = document.querySelectorAll('main a')
        for(const a of as)
            a.classList.remove('strike')
    })

    const strikeNonCached = cacheKeys => {
        caches.open(cacheKeys[0]).then(cache =>
            cache.keys().then(keys => {
                const as = document.querySelectorAll('main a')
                const urls = keys.map(k => k.url)
                for(const a of as)
                    if(urls.indexOf(a.href) === -1)    
                        a.classList.add('strike')
    }))}

    if(navigator.onLine)
        window.dispatchEvent(new Event('online'))
    else
        window.dispatchEvent(new Event('offline'))

</script>
    <script>
function variableResize() {

  
  let bodyStyles = window.getComputedStyle(document.body);	
	
  let root = document.documentElement;
	
	
	const maxWindowSize = bodyStyles.getPropertyValue('--bp-xlarge') * 16;
	const minWindowSize = bodyStyles.getPropertyValue('--bp-small') * 16;
	
	
	const windowWidth = window.innerWidth
	
  
  const pWidthVar = '--p-wdth';
	const pMinFontWidth = bodyStyles.getPropertyValue('--p-wdth-min');
	const pMaxFontWidth = bodyStyles.getPropertyValue('--p-wdth-max');
	scale(pWidthVar, pMinFontWidth, pMaxFontWidth);

  const pWeightVar = '--p-wght';
	const pMinFontWeight = bodyStyles.getPropertyValue('--p-wght-min');
	const pMaxFontWeight = bodyStyles.getPropertyValue('--p-wght-max');
	scale(pWeightVar, pMinFontWeight, pMaxFontWeight);
	
  const h1WidthVar = '--h1-wdth';
	const h1MinFontWidth = bodyStyles.getPropertyValue('--h1-wdth-min');
	const h1MaxFontWidth = bodyStyles.getPropertyValue('--h1-wdth-max');
	scale(h1WidthVar, h1MinFontWidth, h1MaxFontWidth);

  const h1WeightVar = '--h1-wght';
	const h1MinFontWeight = bodyStyles.getPropertyValue('--h1-wght-min');
	const h1MaxFontWeight = bodyStyles.getPropertyValue('--h1-wght-max');
	scale(h1WeightVar, h1MinFontWeight, h1MaxFontWeight);
	
  const h2WidthVar = '--h2-wdth';
	const h2MinFontWidth = bodyStyles.getPropertyValue('--h2-wdth-min');
	const h2MaxFontWidth = bodyStyles.getPropertyValue('--h2-wdth-max');
	scale(h2WidthVar, h2MinFontWidth, h2MaxFontWidth);

  const h2WeightVar = '--h2-wght';
	const h2MinFontWeight = bodyStyles.getPropertyValue('--h2-wght-min');
	const h2MaxFontWeight = bodyStyles.getPropertyValue('--h2-wght-max');
	scale(h2WeightVar, h2MinFontWeight, h2MaxFontWeight);
	
	function scale(varName, minValue, maxValue) {
		
		minValue = minValue * 1;
		maxValue = maxValue * 1;

		
		const percent = (windowWidth - minWindowSize) / (maxWindowSize - minWindowSize);
		if (maxValue < minValue) {
			var valueScale = minValue - (percent * (minValue - maxValue));
		} else {
			var valueScale = (percent * (maxValue - minValue)) + minValue;
		}
	  
		
		const newValue = windowWidth > maxWindowSize
		   ? maxValue 
		   : windowWidth < minWindowSize 
				? minValue 
				: valueScale;
	   
		
		root.style.setProperty(varName, newValue);
	}
}

window.addEventListener("load", variableResize);
window.addEventListener("resize", variableResize);

</script>
    <script>
  const el = document.querySelector("#to_nav")
  el.addEventListener("click", e => {
    const x = document.querySelector("#primary_nav")
    if (x.style.display === "block") {
      x.removeAttribute("style")
    } else {
      x.style.display = "block";
    }
  })
  window.addEventListener('click', e => {
    const x = document.querySelector("#primary_nav")
    const y = document.querySelector("#to_nav")
    if (!y.contains(e.target) && x.style.display === "block") {
      x.removeAttribute("style")
    } 

    const th = document.querySelector("#theme")
    const x1 = document.querySelector(".dropdown-content")

    if (!th.contains(e.target) && ! x1.contains(e.target) && x1.style.display === "block") {
      x1.removeAttribute("style")
    } 
  })
</script>

</body>
</html>